if (! (checkalias mapstartalways)) [ mapstartalways = "" ]
if (! (checkalias onNewMap)) [ onNewMap = "" ]
if (! (checkalias autosavemap)) [ autosavemap = 0 ]
if (! (checkalias timeBetAutoSaves)) [ timeBetAutoSaves = 300000 ] // Once every 5 minutes.

autoSaveCheck = [ sleep $timeBetAutoSaves [ doAutoSave ] ]

if (! (strstr $mapstartalways autoSaveCheck)) [ add2alias mapstartalways [ if $autosavemap autoSaveCheck ] ]
if (! (strstr $onNewMap autoSaveCheck)) [ add2alias onNewMap [ if $autosavemap autoSaveCheck ] ]

doAutoSave = [
  if (! (strstr $defaultmaps (curmap 1))) [
    if (|| $editing (= $gamemode 1)) [
      if $autosavemap [
        oldmapbackups = $mapbackupsonsave
        mapbackupsonsave 0 // Temporarily turn off map backups to avoid clutter.
        savemap (curmap 1)
        mapbackupsonsave $oldmapbackups
      ]
    ]
  ]
  autoSaveCheck
]