// Decides whether to open the admin or normal in-game menu.
alias ingamemenu [ if (currole 1) [ showmenu "In-game admin" ] [ showmenu In-game ] ]

// "Join server" menu.
alias joinservermenu [ searchlan 1
		showallservers 1
		updatefrommaster
		showmenu server
	]

// Normal in-game menu that opens when pressing escape and connected to a game.
newmenu "In-game"

menuitemtextinput "Nickname:  " "result $curname" "name $arg1"
menuitem "Change to the enemy team"        "changeteam"
menuitem "Change weapon"        	"showmenu Weapons"
menuitem "Change player skin"          [showmenu (at [CLA RVSF] (curteam))]
menuitem "" -1
menuitem "Set mode/map"			"showmenu Gamemode"
menuitem "Kick/ban player"		"showmenu kick/ban"
menuitem "Adjust teams"			[ showmenu "Team adjustment" ]
menuitem "Download a demo"		[ listdemos; showmenu "Download demo" ]
menuitem "" -1
menuitem "4Main menu..."		[ closemenu In-game; showmenu main ]
menuitem "4Browse servers..."		[ closemenu "In-game"; joinservermenu ]
menuitem "3Disconnect from server"	"disconnect"
menuitem "3Quit AssaultCube"		"savequit"

// In-game menu that opens if when you press escape if you're admin state and connected to a game.
newmenu "In-game admin"

menuitem "Set mode/map"			"showmenu Gamemode"
menuitem "Kick/ban player"		"showmenu kick/ban"
menuitem "Adjust teams"			[ showmenu "Team adjustment" ]
menuitem "Change mastermode" 		"showmenu Mastermode"
menuitem "Change the server description" "saycommand /serverdesc "
menuitem "Give admin"			[ showmenu "give admin" ]
menuitem "" -1
menuitemtextinput "Nickname:  " "result $curname" "name $arg1"
menuitem "Change to the enemy team"        "changeteam"
menuitem "Change weapon"        	"showmenu Weapons"
menuitem "Change player skin"          [showmenu (at [CLA RVSF] (curteam))]
menuitem "Demos"			"showmenu Demo"
menuitem "" -1
menuitem "4Main menu..."		[ closemenu "In-game admin"; showmenu main ]
menuitem "4Browse servers..."		[ closemenu "In-game admin"; joinservermenu ]
menuitem "3Disconnect from server"	"disconnect"
menuitem "3Quit AssaultCube"		"savequit"

// Multiplayer menu only opens through the main menu (when disconnected).
newmenu multiplayer

menuitem "Join a server"		"joinservermenu"
menuitem "Join a LAN server"		"searchlan 2; showallservers 0; showmenu server"
menuitem "Custom connect"		[ showmenu "Custom connect" ]
menuitem "Connect as Admin"		[ showmenu "Admin connect" ]
menuitem "" -1
menuitem "Force serverlist update"	"updatefrommaster 1; showmenu server"

// Fancy custom connect menu.
newmenu "Custom connect"

menuinit [ alias cc1 ""; alias cc2 ""; alias cc3 "" ]	// Resets the aliases
menuitemtextinput "Server IP/DNS: 		"	"" "alias cc1 $arg1" 
menuitemtextinput "Server port (optional): 	"	"" "alias cc2 $arg1"
menuitemtextinput "Server password (optional): 	"	"" "alias cc3 $arg1"
menuitem "" -1
menuitem "2		  [ Connect ]			" "connect $cc1 $cc2 $cc3"

// Connect to a menu as admin.
newmenu "Admin connect"

menuinit [ alias acc1 ""; alias acc2 ""; alias acc3 ""; echo "3To use this menu to connect as administrator, you will need to know the administrator password for your server." ]	// Resets the aliases
menuitemtextinput "Server IP/DNS: 		"		"" "alias acc1 $arg1" 
menuitemtextinput "Server port (optional):	"		"" "alias acc2 $arg1"
menuitemtextinput "Server admin password: 	"		"" "alias acc3 $arg1"
menuitem "" -1
menuitem "2	      [ Admin connect ]		" "connectadmin $acc1 $acc2 $acc3"

newmenu "Server description"

menuinit [ alias serverdesctext ""; echo "3This will change the server description (in-between the suffixes specified by the server owner) to what you choose for one game only." ]	// Resets the aliases
menuitemtextinput "Server description: 		"		"" "alias serverdesctext $arg1"   
menuitem "" -1
menuitem "2      [ Change server description ]	" "serverdesc $serverdesctext"


newmenu kick/ban

menuitem "Kick a player"	[ showmenu "kick player" ]
menuitem "Ban a player"		[ showmenu "ban player" ]
menuitem "Remove all bans"	"removebans"

newmenu "Team adjustment"

menuitem "Initiate shuffleteams"	"shuffleteams"
menuitem "Force a team change"		[ showmenu "force team" ]
menuitem "Initiate autoteam"		"showmenu Auto-team"

newmenu Gamemode

menuitem "Team Deathmatch"		"mode 0; showmenu maps"
menuitem "Deathmatch"			"mode 2; showmenu maps"
menuitem "Team Survivor"		"mode 4; showmenu maps"
menuitem "Survivor"			"mode 3; showmenu maps"
menuitem "Capture the Flag"		"mode 5; showmenu maps_flags"
menuitem "Hunt the Flag"		"mode 13; showmenu maps"
menuitem "Keep the Flag"		"mode 15; showmenu maps_flags"
menuitem "Team Keep the Flag"		"mode 14; showmenu maps_flags"
menuitem "Pistol Frenzy"		"mode 6; showmenu maps"
menuitem "Last Swiss Standing"		"mode 9; showmenu maps"
menuitem "One Shot, One Kill"		"mode 10; showmenu maps"
menuitem "Team One Shot, One Kill"	"mode 11; showmenu maps"


newmenu Mastermode

menuitem "Unlock the server (open)"		"mastermode 0"
menuitem "Lock the server (private)"		"mastermode 1"

newmenu Auto-team

menuitem "Turn auto-team on"	"autoteam 1"
menuitem "Turn auto-team off"	"autoteam 0"


newmenu voicecom 1 1

menuitem "1. Team Commands" [showmenu "Team Commands"]
menuitem "2. Team State" [showmenu "Team State"]
menuitem "3. Team Talk" [showmenu "Team Talk"]
menuitem "4. Public Talk" [showmenu "Public Talk"]


alias vcrnd [ // pick random shout if possible
    alias len (listlen $arg1)
    if (> $len 1) [
        alias r (rnd $len)
        voicecom (at $arg1 $r) (at $arg2 $r)
    ] [
        voicecom $arg1 $arg2
    ]
]


alias genvcitem [
    if (> (listlen $arg2) 1) [ alias text (at $arg1 0) ] [ alias text $arg1 ] // split multiple shouts
    alias action (concatword vcrnd " [" $arg2 "]" " [" $arg1 "]")
    menuitem (concatword $arg3 ". " $text) $action // add as numbered list
]


newmenu "Team Commands" 1 1

genvcitem "Come on, move!"              comeonmove          1
genvcitem "Cover me!"                   coverme             2
genvcitem "Spread out!"                 spreadout           3
genvcitem "Stay here!"                  stayhere            4
genvcitem "Stay together!"              staytogether        5
genvcitem "Defend the flag!"            defendtheflag       6
genvcitem "Recover the flag!"           recovertheflag      7


newmenu "Team State" 1 1

genvcitem ["Enemy down" "I got one"]    "enemydown igotone" 1
genvcitem "I made contact"              imadecontact        2
genvcitem "I'm attacking"               imattacking         3
genvcitem "I'm on defense"              imondefense         4
genvcitem "Coming in with the flag!"    cominginwiththeflag    5
         

newmenu "Team Talk" 1 1

genvcitem [Yes Affirmative "All right, Sir"]                    "yes affirmative allrightsir"       1
genvcitem ["Negative" "No can do" "There's no way, Sir!"]       "negative nocando theresnowaysir"   2
genvcitem "Sorry"                                               sorry                               3
genvcitem "I'm on your team, man!"                              imonyourteamman                     4
genvcitem ["We did it!" "Go get 'em boys!" "Good job, team!"]   "wedidit gogetemboys goodjobteam"   5

newmenu "Public Talk" 1 1

genvcitem "Nice shot"                   niceshot            1
