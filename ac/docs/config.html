<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <title>ActionCube README</title>
    <meta http-equiv="content-type" content="application/xhtml+xml;charset=utf-8" />
    <link rel="stylesheet" href="docs.css" />
</head>
<body>

<div align="center">

    <div id="header">Rabid Viper Productions</div>
    <div id="main">
    
    <h2>Configuration</h2>
    
    
    <a name="commandline"></a>
    <h3>Command-Line Options</h3>
    
        <p>
            In the file <i>actioncube_server.bat</i> (or the respective .sh file in linux) you can add or
            change command line options:
        </p>
    
        <p>
            <span class="code">-wX</span> sets desired screen width to X, default is <span class="code">-w640</span>
            <br />
            <span class="code">-hY</span> sets desired screen height to Y, default is <span class="code">-h480</span>
            <br />
            <span class="code">-t</span> runs windowed
        </p>
        <p>
            <span class="code">-uN</span> sets the server upstream bandwidth to N bytes per second. only set
                this parameter if you know what you are doing, specifying a wrong value is worse
                than not specifying it at all.
        </p>
        <p>
            <span class="code">-nN</span> sets the server description, for people pinging the server. usually
                does not need to be set if you have a descriptive domain name already, but if you
                set it, keep it short as it may otherwise be truncated, i.e. -nBobsInstagibServer
            
        </p>
        <p>
            <span class="code">-iIP</span> sets the server ip to IP. this option is only useful for people
                running on machines with multiple network interfaces.
        </p>
        <p>
            <span class="code">-mM</span> sets the master server to use for either server (registering) and
                client (updating) to M. M is the base url of the master server and has to end in
                a / and without a http:// prefix, the default is masterserver.cubers.net/cgi-bin/actioncube.pl/.
                If you want your server to be private and not report to the masterserver, use -mlocalhost.
        </p>
        <p>
            <span class="code">-pPASS</span> sets the server password to PASS. Only clients that use the command
                "password PASS" will be able to connect.
        </p>
        <p>
            <span class="code">-cN</span> sets the maximum number of players that can play on this server
                to N (default 6). If more players try to connect they will get a "server full" message.
        </p>
        
        <p>
            <span class="code">-xM</span> sets the master password.
        </p>
        <p>
            <span class="code">-rC</span> sets the maprotation file, e.g. <span class="code">-rconfig/maprot.cfg</span>
        </p>
        
        
        <a name="generalconsolecommands"></a>
        <h3>General console commands and configuration</h3>

        <div class="code">
            bind K A
        </div>
        
            binds key K to commands A (see console language below for what you can put in A). To find out what key names and their default bindings are, look at data/keymap.cfg, then add bind commands to your autoexec.cfg.
        
        <div class="code">
            alias N A
        </div>   

        binds name N to commands A, after which you can use N as a shortcut for A. You may re-bind N as often as you like, and bind N again within the execution of A etc.
        
        <div class="code">
            quit      
        </div>

        quits without asking.

        <div class="code">
            forward / backward / left / right      
        </div>

        move you in said direction (defaults to cursor keys).

        <div class="code">
            attack      
        </div>
        
        fires the current weapon. default = left mouse

        <div class="code">
            jump      
        </div>
        
        triggers a jump. default key space & right mouse.

        <div class="code">
            invmouse B      
        </div>
        
        sets mouse to "flight sim" mode if B is not 0

        <div class="code">
            sensitivity S      
        </div>
        
        sets mouse sensitivity (see autoexec.cfg). with sensitivityscale you can specify a number that the sensitivity is divided by.

        <div class="code">
            fov N      
        </div>
        
        sets your FOV to 10..120.

        <div class="code">
            minmillis N      
        </div>
        
        Sets the minimum number of milliseconds a frame should take. This is for very fast machines that run Cube at hundreds of fps. Default is 5, i.e. try to stay close to 200fps. This command is not exact, i.e. the precise delay it generates depends on OS and other factors... experiment with your ideal setting. To turn it off, simply set it to 0.

        <div class="code">
            fog N      
        </div>
        
        sets fog distance to N (default currently 160). You can do this for tweaking the visual effect of the fog, or if you are on a slow machine, setting the fog to a low value can also be a very effective way to increase fps (if you are geometry limited). Try out different values on big maps / maps which give you low fps.

        <div class="code">
            fogcolour C      
        </div>
        
        Sets fog and clearing colour to C, the default being 0x8099B3. This and the fog variable can be set in the map specific .cfg file.

        <div class="code">
            dynlight R      
        </div>
        
        determines wether dynamic shadows & lights are rendered, providedjust incase they slow your fps down too much. With radius you can specify the radius of a dynamic light (default 16), smaller to maybe gain some speed (0 is off entirely), or bigger to see the effect of dynamic shadows more dramatically (try shooting it past some pillars that have a dark area on the other side... or use the "gamespeed" variable).

        <div class="code">
            lighterror E      
        </div>
        
        Allows you to finetune the amount of "error" the mipmapper/stripifier allow themselves for changing lightlevels. Set to 1 for maximum light quality at the expense of fps, set to some high value to gain fps but with messier lighting (only helps if you are geometry limited). Default = 8. If you change this during play, you have to do a "recalc" to see the effect.

        <div class="code">
            watersubdiv N      
        </div>
        
        determines the subdivision of the water surface in maps, which can greatly affect fps on slow machines. Must be a power of 2: 4 is the default, 8 is recommended for people on slow machines, 2 is nice for fast machines, and 1 is quite OTT. See "waterlevel" (edit reference) on how to add water to your own levels.

        <div class="code">
            maxparticles N  
        </div>
        
        Sets the maximum number of particles rendered at any one time. If more particles are generated than this number, the oldest ones are culled, so you can safely set this number relatively low without loss of information. default 1000.

        <div class="code">
            screenshot      
        </div>
        
        writes out "screenshots/screenshotN.bmp", where N is the number of milliseconds since cube was launched (default key = F12).

        <div class="code">
            musicvol n<br />
            soundvol n      
        </div>
        
        sets the music/sound volume from 0 to 255

        <div class="code">
            soundbufferlen n      
        </div>
        
        (default 512) tweak this if you experience stuttering or lagging sound

        <div class="code">
            gamma n      
        </div>
        
        sets the hardware gamma value to n percent (default 100). May not work if your card/driver doesn't support it.

        <div class="code">
            hidestats b      
        </div>
        
        turns on/off display of fps/rendering stats on the HUD (default = 1).

        <div class="code">
            maxroll n      
        </div>
        
        sets the maximum value your display will roll on strafing (0..20, default = 3)

        <div class="code">
            crosshairsize n      
        </div>
        
        sets the size of your crosshair, 0 being off (default = 3)

        <div class="code">
            crosshairfx b      
        </div>
        
        turns on or of crosshair effects (default 1). when on, the crosshair will go grey when the weapon is reloading, orange when health <= 50, or red when <=25.

        <div class="code">
            exec C      
        </div>
        
        executes all commands in config file C.

        <div class="code">
            newmenu N      
        </div>
        
        creates a new menu with name N. All following menuitem commands will apply to this menu

        <div class="code">
            menuitem N A<br />
            menuitem A      
        </div>
        
        creates a new menuitem with description N and action A. if you only specify 1, then it will be used for both the description and the action. See data/menus.cfg for examples.

        <div class="code">
            showmenu N      
        </div>
        
        displays the menu with name N previously defined, and allows the user to pick an item with the cursor keys. Upon pressing return, the associated action will be executed. pressing ESC will cancel the menu.

        <div class="code">
            history N     
        </div>
        
        Executes the Nth command in the command line history. For example, binding "history 0" to a key allows you to quickly repeat the last command typed in (useful for placing many identical entities etc.)

        <div class="code">
            keymap K N A      
        </div>
        
        sets up the keymap for key code K with name N and default action A. You should never have to use this command manually, use "bind" instead.

        <div class="code">
            lightscale N      
        </div>
        
        used to finetune the "overbright lighting" rendering feature when enabled: lower numbers make the scene brighter, default = 4. After changing this value, you need to use "recalc" to see the differences.

        <div class="code">
            particlesize P      
        </div>
        
        <p>
        scales all particles by percentage P.
        </p>

        <p>
        To use overbright lighting, your card needs to support the "EXT_texture_env_combine" extension (Nvidia from TNT1 and upwards, ATI from rage128/radeon and upwards, but not on voodoos afaik). Overbright lighting uses a different lighting model (lights that overlap "add" rather use the biggest of the two, and lightsources have an exponential rather than linear model), so lighting may look different depending on how the mapper placed the lights. Maps should be made with additive/exponential lighting in mind, however, because soon everyone will have a card that supports this extension.
        </p>

        <p>
        Do not confuse "lightscale" with "gamma", they have different effects. It is best to leave "lightscale" at the default and tune gamma to get the right brightness level for your situation, but you can tune the other way around if you find the saturation level of a certain gamma level more important. changing the lightscale will have an effect on the distribution of lightsources (higher lightscale will make them more like spotlights). Generally, gamma needs to be lower compared to older cube releases.
        </p>
        
        <h3>Console Language</h3>
        
        <p>
            Cube's console language is similar to console languages of other games (e.g. Quake), but is a bit more powerful in 
            that it is almost a full programming language.
        </p>

        <p>
            What is similar to quake is the basic command structure: commands consist of the command itself, followed by any 
            number of arguments seperated by whitespace. you can use "" to quote strings with whitespace in them (such as the 
            actions in bind/alias), and whereever a command is required you can also use ; to sequence multiple commands in one.
        </p>
        <p>
            What is new compared to quake is that you can evaluate aliases and expressions. You can substitute the value of an 
            alias as an argument by prefixing it with a "$" sign, i.e.: <span class="code">echo The current value of x is $x</span> 
            You can even substitute 
            the values of console variables this way, i.e $fov gives the current fov. Some aliases are set automatically, for 
            example $arg1 to $argN are set if you supply arguments when you execute an alias.
        </p>
        <p>
            There are two alternative ways to "" to quote a string: () and []. They work in the same way as "", with the difference 
            that they can be nested infinitely, and that they may contain linefeeds (useful for larger scripts). () is different 
            from [] in that it evaluates the commands contained in it _before_ it evaluates the surrounding command, and substitutes 
            the results. () bracketed strings are called expressions, and combined with some commands made especially for 
            "programming", you have a minimal language: 
        </p>
        
        <div class="code">
            + A B<br />
            - A B<br />      
            * A B<br />
            div A B<br />  
            mod A B<br />
        </div>
        
            (add, substract, multiply, divide, modulo): these all work like the integer operators from other languages. <br />
            Example: <span class="code">echo x squared is (* $x $x)</span>
    
        <div class="code">
            = A B<br />
            < A B<br />      
            > A B<br />
            strcmp A B<br />
        </div>  
        
             (equals, lessthan, greaterthan, stringcompare): comparison operators that return 1 for true and 0 for false.
        
        <div class="code">
            if cond true false
        </div>
        
            executes the true or false part depending on wether cond is "0" or something else. <br />
            Example: <span class="code">if (< $x 10) [ echo x is $x ] [ echo x is too big ]</span>

        <div class="code">
            loop N body      
        </div>
        
            evaluates body N times, and sets the alias "i" from 0 to N-1 for every iteration. <br />
            Example: <span class="code">loop 10 [ echo $i ]</span>

        <div class="code">
            while cond body      
        </div>
        
            evaluates body while cond evaluates to true. Note that cond here has to have [], otherwise it would only be evaluated once.<br />
            Example (same as the loop): <span class="code">alias i 0; while [ (< $i 10) ] [ echo $i; alias i (+ $i 1) ]</span>

        <div class="code">
                concat S...      
        </div>

            concatenates all the arguments into alias "s"

        <div class="code">
                concatword S...      
        </div>
        
            same as concat but without spaces between the elements.

        <div class="code">
                at S N      
        </div>
        
            grabs the Nth word out of string S and puts it into alias "s"

        <div class="code">
                onrelease A      
        </div>
        
            only executes A if the command is executed on the release of a key/button (must be in an action in a bind or an alias in a bind).

        <div class="code">
                sleep N C    
        </div>
        
            executes command C after N milliseconds have passed. only one command can be sleeping at any one time. gets reset at map load.  

        <div class="code">
                (millis)      
        </div>
        
            returns the number of milliseconds since engine start.

            variables that are only really useful when used as value:

        <div class="code">
                $editing      
        </div>
        
            true when in edit mode

        <div class="code">
                $flrceil      
        </div>

        <p>
            0 when the player looks at the floor, and 2 when looking at the ceiling.  
        </p>
    
        <h3>How The Cube Engine Works</h3>
        
        <p>
            The cube engine is simplicity itself. The whole map consists of a large 2D array of "cubes", each with a floor and ceiling height, textures (for floor/ceiling/wall) and other properties. These cubes are grouped 2x2 at a time recursively into a "quad tree", which is used hold bigger cubes which can be rendered faster. For those who have edited doom, this is very similar to having a lot of square sectors but at overlapping sizes. This is results in a map that can have no room over room (yet), and is pretty cubic, except for the odd slope/slant here and there.
        </p>
        <p>
            The floor size of a single unit (single cube) is similar to about 16x16 units in games such as doom & quake, so a staircase step is usually 1 unit, a wall 8 units high etc.
        </p>
        <p>
            Cube renders this world by first determining which cubes are visible using a "dynamic occlusion culling" algorithm and frustrum culling. You can see the effect of this when you switch to edit mode (E), and then fly out above a map: you'll see parts of the map dropping away as you move. The remaining cubes are then rendered in their most efficient size (i.e. cube will render a mixture of 1x1 2x2 4x4 etc. size cubes, depending on wether they have the same properties: height, texturing etc.).
        </p>
        <p>
            If you are on a fast machine, or you are playing a simple/small map, cube will simply render all of these visible cubes (this is indicated by LOD at its maximum of 250 on the hud). Cube can however make complex maps run fast even on slower computers by a technique called LOD: this will render cubes that are further away using bigger approximations (2x2 and up), even the properties of the constituent cubes don't match exactly. This reduces the amount of polys to be rendered tremendously, and thus allows even slow machines to have a consistent frame rate (cube will adapt the LOD figure every frame to aim for the fps you specify). The downside is of course that if the approximations are visible closeup, this can lead to ugly graphical glitches (this is called "popup" because it changes as you move). So in the end the choice is up to you: good fps or constant visual quality (most engines only cater for the latter).         
        </p>
   
    </div>
    <div id="footer"><a href="../README.html">&larr; BACK TO MAIN SITE</a></div>
    
</div>

</body>
</html>
